

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>41. 网络 &#8212; Python量化经济学入门</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=bd0785fbb14d8d2bd4d9ae501d79ed8d3bc089ec" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=d9faaf6c4b57726f74ba012412af1f5681bdff87"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'networks';</script>
    <link rel="canonical" href="https://quantecon.github.io/lecture-intro.zh-cn/networks.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="42. 多种商品的供需关系" href="supply_demand_multiple_goods.html" />
    <link rel="prev" title="40. 就业的湖泊模型" href="lake_model.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=本课程是由托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）设计和撰写的计算经济学入门讲座。 />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="网络"/>
<meta name="twitter:description" content="本课程是由托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）设计和撰写的计算经济学入门讲座。">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="网络" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://quantecon.github.io/lecture-intro.zh-cn/networks.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="本课程是由托马斯·萨金特（Thomas J. Sargent）和约翰·斯塔胡斯基（John Stachurski）设计和撰写的计算经济学入门讲座。" />
<meta property="og:site_name" content="Python量化经济学入门" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=networks>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">41.1. 概述</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">41.2. 经济和金融网络</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">41.2.1. 例子：飞机出口网络</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">41.2.2. 例子：马尔可夫链</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">41.3. 图论简介</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">41.3.1. 关键定义</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#networkx">41.3.2. Networkx中的有向图</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strongly-connected">41.3.3. 连通性</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">41.4. 加权图</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">41.5. 加权图</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">41.5.1. 国际私人信贷流动网络</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">41.5.2. 定义</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">41.6. 邻接矩阵</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">41.7. 性质</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">41.8. 网络中心性</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">41.8.1. 度中心性</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">41.9. 特征向量中心性</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">41.9.1. 卡茨中心性</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">41.9.2. 权威与枢纽</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">41.10. 进一步阅读</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">41.11. 练习</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo.png" class="logo logo-img" alt="logo"></a>
                                    
                                    <a href=https://quantecon.org><img src="_static/quantecon-logo-transparent.png" class="dark-logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Python量化经济学入门</a></p>

                        <p class="qe-page__header-subheading">网络</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>托马斯·萨金特（Thomas J. Sargent）</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>约翰·斯塔胡斯基（John Stachurski）</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">41. </span>网络<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>quantecon<span class="w"> </span>quantecon-book-networks<span class="w"> </span>wbgapi
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: quantecon in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (0.8.0)
Requirement already satisfied: quantecon-book-networks in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (1.3.1)
Requirement already satisfied: wbgapi in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (1.0.12)
Requirement already satisfied: numba&gt;=0.49.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (0.60.0)
Requirement already satisfied: numpy&gt;=1.17.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (1.26.4)
Requirement already satisfied: requests in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (2.32.3)
Requirement already satisfied: scipy&gt;=1.5.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (1.13.1)
Requirement already satisfied: sympy in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon) (1.13.2)
Requirement already satisfied: pandas in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon-book-networks) (2.2.2)
Requirement already satisfied: matplotlib in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon-book-networks) (3.9.2)
Requirement already satisfied: pandas-datareader in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon-book-networks) (0.10.0)
Requirement already satisfied: networkx in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from quantecon-book-networks) (3.3)
Requirement already satisfied: PyYAML in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from wbgapi) (6.0.1)
Requirement already satisfied: tabulate in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from wbgapi) (0.9.0)
Requirement already satisfied: llvmlite&lt;0.44,&gt;=0.43.0dev0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from numba&gt;=0.49.0-&gt;quantecon) (0.43.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from matplotlib-&gt;quantecon-book-networks) (1.2.0)
Requirement already satisfied: cycler&gt;=0.10 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from matplotlib-&gt;quantecon-book-networks) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from matplotlib-&gt;quantecon-book-networks) (4.51.0)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from matplotlib-&gt;quantecon-book-networks) (1.4.4)
Requirement already satisfied: packaging&gt;=20.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from matplotlib-&gt;quantecon-book-networks) (24.1)
Requirement already satisfied: pillow&gt;=8 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from matplotlib-&gt;quantecon-book-networks) (10.4.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from matplotlib-&gt;quantecon-book-networks) (3.1.2)
Requirement already satisfied: python-dateutil&gt;=2.7 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from matplotlib-&gt;quantecon-book-networks) (2.9.0.post0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pytz&gt;=2020.1 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from pandas-&gt;quantecon-book-networks) (2024.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from pandas-&gt;quantecon-book-networks) (2023.3)
Requirement already satisfied: lxml in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from pandas-datareader-&gt;quantecon-book-networks) (5.2.1)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (3.7)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (2.2.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from requests-&gt;quantecon) (2024.8.30)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from sympy-&gt;quantecon) (1.3.0)
Requirement already satisfied: six&gt;=1.5 in /home/runner/miniconda3/envs/quantecon/lib/python3.12/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib-&gt;quantecon-book-networks) (1.16.0)
</pre></div>
</div>
</div>
</details>
</div>
<section id="id2">
<h2><span class="section-number">41.1. </span>概述<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>近年来，<a class="reference external" href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E7%A7%91%E5%AD%A6">网络科学</a>领域迅速发展，成为研究复杂系统中对象间关系的重要方法。</p>
<p>网络科学关注的是实体之间的连接和互动方式。</p>
<p><a class="reference external" href="https://baike.baidu.com/item/www/109924?fromtitle=%E4%B8%87%E7%BB%B4%E7%BD%91&amp;amp;fromid=215515">万维网</a>是一个典型例子，其中网页通过超链接形成庞大的信息网络，使信息能够高效传播和获取。</p>
<p><a class="reference external" href="https://baike.baidu.com/item/%E7%A5%9E%E7%BB%8F%E5%9B%9E%E8%B7%AF">人脑</a>是自然界中最复杂的网络之一，神经元之间的连接构成了复杂的神经回路，支持着我们的思考、记忆和行为。</p>
<p><a class="reference external" href="https://baike.baidu.com/item/%E4%BA%BA%E5%B7%A5%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/382460">人工神经网络</a>正是受到大脑结构的启发，通过在简单计算单元之间建立连接，实现复杂的模式识别和决策功能。</p>
<p>流行病学家在研究COVID-19等<a class="reference external" href="https://baike.baidu.com/item/%E4%BC%A0%E6%9F%93%E7%97%85%E6%A8%A1%E5%9E%8B/5130035">疾病传播</a>时，分析人群接触网络对理解疫情扩散路径和制定防控策略至关重要。</p>
<p>在运筹学领域，网络分析被广泛应用于解决最小成本流、旅行商问题、<a class="reference external" href="https://baike.baidu.com/item/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84">最短路径</a>和资源分配等实际问题。</p>
<p>本讲座将重点介绍经济和金融网络，探讨网络结构如何影响经济活动和金融稳定性。</p>
<p>内容部分参考了<a class="reference external" href="https://networks.quantecon.org">《经济网络》</a>教材，但我们将以更基础的方式进行讲解，适合初学者理解。</p>
<p>我们需要以下导入。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">quantecon</span> <span class="k">as</span> <span class="nn">qe</span>

<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">quantecon_book_networks.input_output</span> <span class="k">as</span> <span class="nn">qbn_io</span>
<span class="kn">import</span> <span class="nn">quantecon_book_networks.data</span> <span class="k">as</span> <span class="nn">qbn_data</span>

<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">FONTPATH</span> <span class="o">=</span> <span class="s2">&quot;fonts/SourceHanSerifSC-SemiBold.otf&quot;</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">fontManager</span><span class="o">.</span><span class="n">addfont</span><span class="p">(</span><span class="n">FONTPATH</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Source Han Serif SC&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h2><span class="section-number">41.2. </span>经济和金融网络<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>经济学中的网络应用广泛，主要包括以下几类：</p>
<ul class="simple">
<li><p>金融网络</p></li>
<li><p>生产网络</p></li>
<li><p>贸易网络</p></li>
<li><p>运输网络</p></li>
<li><p>社交网络</p></li>
</ul>
<p>社交网络在塑造市场情绪和影响消费者决策方面发挥着重要作用。</p>
<p>金融网络的结构能够揭示金融系统中潜在的脆弱点和系统性风险。</p>
<p>生产网络则决定了贸易模式、创新传播途径以及局部经济冲击如何在整个经济体系中扩散。</p>
<p>为了更直观地理解这些网络的特性和影响，下面我们通过一些具体例子来进行说明。</p>
<section id="id4">
<h3><span class="section-number">41.2.1. </span>例子：飞机出口网络<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>以下图表展示了2019年全球大型商用飞机的国际贸易网络，数据来源于国际贸易数据SITC第2修订版。</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ch1_data</span> <span class="o">=</span> <span class="n">qbn_data</span><span class="o">.</span><span class="n">introduction</span><span class="p">()</span>
<span class="n">export_figures</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">DG</span> <span class="o">=</span> <span class="n">ch1_data</span><span class="p">[</span><span class="s1">&#39;aircraft_network&#39;</span><span class="p">]</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">ch1_data</span><span class="p">[</span><span class="s1">&#39;aircraft_network_pos&#39;</span><span class="p">]</span>

<span class="n">centrality</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">eigenvector_centrality</span><span class="p">(</span><span class="n">DG</span><span class="p">)</span>
<span class="n">node_total_exports</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">node_total_exports</span><span class="p">(</span><span class="n">DG</span><span class="p">)</span>
<span class="n">edge_weights</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">edge_weights</span><span class="p">(</span><span class="n">DG</span><span class="p">)</span>

<span class="n">node_pos_dict</span> <span class="o">=</span> <span class="n">pos</span>

<span class="n">node_sizes</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">normalise_weights</span><span class="p">(</span><span class="n">node_total_exports</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">edge_widths</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">normalise_weights</span><span class="p">(</span><span class="n">edge_weights</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">node_colors</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">colorise_weights</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">centrality</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span><span class="n">color_palette</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">)</span>
<span class="n">node_to_color</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">DG</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span><span class="n">node_colors</span><span class="p">))</span>
<span class="n">edge_colors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">src</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">DG</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
    <span class="n">edge_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_to_color</span><span class="p">[</span><span class="n">src</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">DG</span><span class="p">,</span>
                       <span class="n">node_pos_dict</span><span class="p">,</span>
                       <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span>
                       <span class="n">node_size</span><span class="o">=</span><span class="n">node_sizes</span><span class="p">,</span>
                       <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                       <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">DG</span><span class="p">,</span>
                        <span class="n">node_pos_dict</span><span class="p">,</span>
                        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">DG</span><span class="p">,</span>
                       <span class="n">node_pos_dict</span><span class="p">,</span>
                       <span class="n">edge_color</span><span class="o">=</span><span class="n">edge_colors</span><span class="p">,</span>
                       <span class="n">width</span><span class="o">=</span><span class="n">edge_widths</span><span class="p">,</span>
                       <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">arrowsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                       <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                       <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
                       <span class="n">node_size</span><span class="o">=</span><span class="n">node_sizes</span><span class="p">,</span>
                       <span class="n">connectionstyle</span><span class="o">=</span><span class="s1">&#39;arc3,rad=0.15&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<figure class="align-default" id="aircraft-network">
<a class="reference internal image-reference" href="_images/78b00b52ca0fbb1c676cde09decfbcd4e6dc04267c763b2fd21c4ef7fc80465a.png"><img alt="_images/78b00b52ca0fbb1c676cde09decfbcd4e6dc04267c763b2fd21c4ef7fc80465a.png" src="_images/78b00b52ca0fbb1c676cde09decfbcd4e6dc04267c763b2fd21c4ef7fc80465a.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 41.1 </span><span class="caption-text">商用飞机网络</span><a class="headerlink" href="#aircraft-network" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>在这个网络图中，圆圈表示<strong>节点</strong>或<strong>顶点</strong>，它们代表不同的国家。</p>
<p>连接各国的箭头称为<strong>边</strong>或<strong>链接</strong>，表示贸易关系。</p>
<p>节点的大小反映了该国的总出口量，而边的宽度则表示向目标国家的出口规模。</p>
<p>（图表数据基于重量在15,000公斤以上的商用飞机贸易，数据来源为CID Dataverse。）</p>
<p>从图中可以清楚地看出，美国、法国和德国是全球飞机贸易的主要出口中心。</p>
<p>接下来，我们将探讨如何用数学方法来量化网络中的这些特性。</p>
</section>
<section id="id5">
<h3><span class="section-number">41.2.2. </span>例子：马尔可夫链<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>在我们之前学习的<a class="reference internal" href="markov_chains_I.html#mc-eg2"><span class="std std-ref">马尔可夫链</span></a>讲座中，我们分析了一个商业周期模型，其中包含三种经济状态：</p>
<ul class="simple">
<li><p>“ng”：表示”正常增长”阶段</p></li>
<li><p>“mr”：表示”轻度衰退”阶段</p></li>
<li><p>“sr”：表示”严重衰退”阶段</p></li>
</ul>
<p>下面这个网络图展示了这些状态之间的关系：</p>
<img alt="_images/mc.png" class="align-center" id="mc-networks" src="_images/mc.png" />
<p>这是一个网络的例子，其中节点集 <span class="math notranslate nohighlight">\(V\)</span> 等于状态集：</p>
<div class="math notranslate nohighlight">
\[
    V = \{ \text{&quot;ng&quot;, &quot;mr&quot;, &quot;sr&quot;} \}
\]</div>
<p>节点之间的边表示一个月的转移概率。</p>
</section>
</section>
<section id="id6">
<h2><span class="section-number">41.3. </span>图论简介<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h2>
<p>看完这些例子后，让我们深入一些理论基础。</p>
<p>这些理论框架将帮助我们更系统地分析网络结构。</p>
<p>网络科学的理论基础主要来自数学中的<a class="reference external" href="https://baike.baidu.com/item/%E5%9B%BE%E8%AE%BA/1433806">图论</a>。</p>
<p>虽然图论可以非常复杂，但我们只需要掌握一些基本概念。</p>
<p>即使是这些基础知识，也足以让我们探讨经济和金融网络中的许多有趣且重要的现象。</p>
<p>在本讲座中，我们主要关注”有向”图，这类图中的连接是不对称的（箭头通常只从一个节点指向另一个节点，而不一定有返回的箭头）。</p>
<p>例如，</p>
<ul class="simple">
<li><p>银行 <span class="math notranslate nohighlight">\(A\)</span> 向银行 <span class="math notranslate nohighlight">\(B\)</span> 贷款</p></li>
<li><p>公司 <span class="math notranslate nohighlight">\(A\)</span> 向公司 <span class="math notranslate nohighlight">\(B\)</span> 供应商品</p></li>
<li><p>个人 <span class="math notranslate nohighlight">\(A\)</span> 在特定社交网络上”关注”个人 <span class="math notranslate nohighlight">\(B\)</span></p></li>
</ul>
<p>（”无向”图，即连接是对称的，是有向图的一种特殊情况——我们只需要保证每个从 <span class="math notranslate nohighlight">\(A\)</span> 指向 <span class="math notranslate nohighlight">\(B\)</span> 的箭头都配对一个从 <span class="math notranslate nohighlight">\(B\)</span> 指向 <span class="math notranslate nohighlight">\(A\)</span> 的箭头。）</p>
<section id="id7">
<h3><span class="section-number">41.3.1. </span>关键定义<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<p>一个<strong>有向图</strong>由两个基本元素构成：</p>
<ol class="arabic simple">
<li><p>一个有限节点集 <span class="math notranslate nohighlight">\(V\)</span> 和</p></li>
<li><p>一组有序对 <span class="math notranslate nohighlight">\((u, v)\)</span>，其中 <span class="math notranslate nohighlight">\(u, v \in V\)</span></p></li>
</ol>
<p><span class="math notranslate nohighlight">\(V\)</span> 中的元素称为图的<strong>顶点</strong>或<strong>节点</strong>。</p>
<p>有序对 <span class="math notranslate nohighlight">\((u,v)\)</span> 称为图的<strong>边</strong>，所有边的集合通常记为 <span class="math notranslate nohighlight">\(E\)</span>。</p>
<p>从直观上看，边 <span class="math notranslate nohighlight">\((u,v)\)</span> 表示从节点 <span class="math notranslate nohighlight">\(u\)</span> 指向节点 <span class="math notranslate nohighlight">\(v\)</span> 的一个箭头。</p>
<p>（这种表示方法很自然，因为箭头完全由其起点和终点确定。）</p>
<p>以 <a class="reference internal" href="#aircraft-network"><span class="std std-numref">Fig. 41.1</span></a> 中的飞机出口网络为例：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V\)</span> 包含数据集中的所有国家。</p></li>
<li><p><span class="math notranslate nohighlight">\(E\)</span> 包含网络中的所有连接，每个连接代表一个国家向另一个国家出口飞机的贸易关系。</p></li>
</ul>
<p>下面我们再看一些其它的例子。</p>
<p>下面显示了两个图，每个图都有三个节点。</p>
<figure class="align-default" id="poverty-trap-1">
<img alt="_images/poverty_trap_1.png" src="_images/poverty_trap_1.png" />
<figcaption>
<p><span class="caption-number">Fig. 41.2 </span><span class="caption-text">贫困陷阱</span><a class="headerlink" href="#poverty-trap-1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>现在，我们构造一个具有相同节点但具有不同边的图。</p>
<figure class="align-default" id="poverty-trap-2">
<img alt="_images/poverty_trap_2.png" src="_images/poverty_trap_2.png" />
<figcaption>
<p><span class="caption-number">Fig. 41.3 </span><span class="caption-text">贫困陷阱</span><a class="headerlink" href="#poverty-trap-2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>在这些图中，箭头（边）可以理解为表示在给定时间单位内从一个状态转移到另一个状态的概率。</p>
<p>一般来说，当存在边 <span class="math notranslate nohighlight">\((u, v)\)</span> 时，我们称节点 <span class="math notranslate nohighlight">\(u\)</span> 是 <span class="math notranslate nohighlight">\(v\)</span> 的<strong>直接前驱</strong>，而节点 <span class="math notranslate nohighlight">\(v\)</span> 是 <span class="math notranslate nohighlight">\(u\)</span> 的<strong>直接后继</strong>。</p>
<p>对于任意节点 <span class="math notranslate nohighlight">\(v \in V\)</span>，我们定义：</p>
<ul class="simple">
<li><p><strong>入度</strong> <span class="math notranslate nohighlight">\(i_d(v)\)</span> 是指向节点 <span class="math notranslate nohighlight">\(v\)</span> 的边数，即 <span class="math notranslate nohighlight">\(v\)</span> 的直接前驱数量</p></li>
<li><p><strong>出度</strong> <span class="math notranslate nohighlight">\(o_d(v)\)</span> 是从节点 <span class="math notranslate nohighlight">\(v\)</span> 出发的边数，即 <span class="math notranslate nohighlight">\(v\)</span> 的直接后继数量</p></li>
</ul>
</section>
<section id="networkx">
<h3><span class="section-number">41.3.2. </span>Networkx中的有向图<a class="headerlink" href="#networkx" title="Permalink to this heading">#</a></h3>
<p>Python包 <a class="reference external" href="https://networkx.org/">Networkx</a> 为表示有向图提供了一个便捷的数据结构，并实现了许多用于分析它们的常见例程。</p>
<p>作为示例，让我们使用Networkx重新创建 <a class="reference internal" href="#poverty-trap-2"><span class="std std-numref">Fig. 41.3</span></a>。</p>
<p>为此，我们首先创建一个空的 <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code> 对象：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_p</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>接下来，我们用节点和边来填充它。</p>
<p>为此，我们列出所有边的列表，其中<em>贫穷</em>用<em>p</em>表示，以此类推：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>最后，我们将边添加到我们的 <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code> 对象中：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">:</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">e</span>
    <span class="n">G_p</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>或者，我们可以使用 <code class="docutils literal notranslate"><span class="pre">add_edges_from</span></code> 方法。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_p</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>添加边会自动添加节点，所以 <code class="docutils literal notranslate"><span class="pre">G_p</span></code> 现在是我们图的正确表示。</p>
<p>我们可以用以下代码通过Networkx绘制图来验证这一点：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_spring</span><span class="p">(</span><span class="n">G_p</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
               <span class="n">connectionstyle</span><span class="o">=</span><span class="s1">&#39;arc3,rad=0.25&#39;</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/6f11fc0e7ac1b1bbe3fcb9ed52b3629e20b9118feb31eba06547de5186a5c015.png"><img alt="_images/6f11fc0e7ac1b1bbe3fcb9ed52b3629e20b9118feb31eba06547de5186a5c015.png" src="_images/6f11fc0e7ac1b1bbe3fcb9ed52b3629e20b9118feb31eba06547de5186a5c015.png" style="width: 80%;" /></a>
</div>
</div>
<p>上面得到的图形与<a class="reference internal" href="#poverty-trap-2"><span class="std std-numref">Fig. 41.3</span></a>中的原始有向图相匹配。</p>
<p><code class="docutils literal notranslate"><span class="pre">DiGraph</span></code>对象有计算节点入度和出度的方法。</p>
<p>例如，</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_p</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
</section>
<section id="strongly-connected">
<span id="id8"></span><h3><span class="section-number">41.3.3. </span>连通性<a class="headerlink" href="#strongly-connected" title="Permalink to this heading">#</a></h3>
<p>接下来，我们研究网络中的连通性概念，这对理解经济网络的结构和影响至关重要。</p>
<p>当节点<span class="math notranslate nohighlight">\(u\)</span>和<span class="math notranslate nohighlight">\(v\)</span>相同，或者存在一条从<span class="math notranslate nohighlight">\(u\)</span>到<span class="math notranslate nohighlight">\(v\)</span>的路径（一系列相连的边）时，我们说节点<span class="math notranslate nohighlight">\(v\)</span>从节点<span class="math notranslate nohighlight">\(u\)</span><strong>可达</strong>。</p>
<ul class="simple">
<li><p>这种关系记为<span class="math notranslate nohighlight">\(u \to v\)</span>
（直观地说，这表示有一条或多条箭头从<span class="math notranslate nohighlight">\(u\)</span>指向<span class="math notranslate nohighlight">\(v\)</span>。）</p></li>
</ul>
<p>举个例子，考虑一个表示生产网络的有向图：</p>
<ul class="simple">
<li><p>节点集<span class="math notranslate nohighlight">\(V\)</span>中的元素代表不同的工业部门</p></li>
<li><p>如果存在边<span class="math notranslate nohighlight">\((i, j)\)</span>，表示部门<span class="math notranslate nohighlight">\(i\)</span>为部门<span class="math notranslate nohighlight">\(j\)</span>提供产品或服务</p></li>
</ul>
<p>在这种情况下，<span class="math notranslate nohighlight">\(m \to \ell\)</span>意味着部门<span class="math notranslate nohighlight">\(m\)</span>是部门<span class="math notranslate nohighlight">\(\ell\)</span>的上游供应商。</p>
<p>当<span class="math notranslate nohighlight">\(u \to v\)</span>且<span class="math notranslate nohighlight">\(v \to u\)</span>同时成立时，我们说节点<span class="math notranslate nohighlight">\(u\)</span>和<span class="math notranslate nohighlight">\(v\)</span>是<strong>相互可达的</strong>或<strong>相通的</strong>。</p>
<p>如果图中的任意两个节点都是相互可达的，我们称这个图是<strong>强连通的</strong>。</p>
<p>比较我们之前的例子：<a class="reference internal" href="#poverty-trap-1"><span class="std std-numref">Fig. 41.2</span></a>是强连通的，因为任意两个节点之间都存在路径；
而在<a class="reference internal" href="#poverty-trap-2"><span class="std std-numref">Fig. 41.3</span></a>中，由于富人节点无法从穷人节点到达，所以它不是强连通的。</p>
<p>我们可以使用NetworkX库来验证这一点，通过构建图并调用<code class="docutils literal notranslate"><span class="pre">nx.is_strongly_connected</span></code>函数：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">G1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G1</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">),(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">),(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)])</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span> <span class="n">with_labels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/933c1d183a75d7f0973fafd3bf9dbdb209ddbcf9b28c1685d99851c3e80aa88b.png"><img alt="_images/933c1d183a75d7f0973fafd3bf9dbdb209ddbcf9b28c1685d99851c3e80aa88b.png" src="_images/933c1d183a75d7f0973fafd3bf9dbdb209ddbcf9b28c1685d99851c3e80aa88b.png" style="width: 80%;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">(</span><span class="n">G1</span><span class="p">)</span>    <span class="c1">#检查上面的图是否强连通</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">G2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G2</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)])</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G2</span><span class="p">,</span> <span class="n">with_labels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1b3b78b223002ca21f2e61dba1a27978109175ece945af05ee4058cb0e1aebef.png"><img alt="_images/1b3b78b223002ca21f2e61dba1a27978109175ece945af05ee4058cb0e1aebef.png" src="_images/1b3b78b223002ca21f2e61dba1a27978109175ece945af05ee4058cb0e1aebef.png" style="width: 80%;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">(</span><span class="n">G2</span><span class="p">)</span>    <span class="c1">#检查上面的图是否强连通</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id9">
<h2><span class="section-number">41.4. </span>加权图<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h2>
</section>
<section id="id10">
<h2><span class="section-number">41.5. </span>加权图<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h2>
<p>在加权图中，每条边都被赋予一个数值权重，表示连接强度或其他量化特征。</p>
<section id="id11">
<h3><span class="section-number">41.5.1. </span>国际私人信贷流动网络<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h3>
<p>下图展示了一个加权图的实例：国家间私人银行的资金流动（贷款）网络。边的粗细表示资金流动的规模，节点的大小反映了该国在网络中的重要性。</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">ch1_data</span><span class="p">[</span><span class="s2">&quot;adjacency_matrix&quot;</span><span class="p">][</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span>
<span class="n">Z_visual</span><span class="o">=</span> <span class="n">ch1_data</span><span class="p">[</span><span class="s2">&quot;adjacency_matrix&quot;</span><span class="p">][</span><span class="s2">&quot;Z_visual&quot;</span><span class="p">]</span>
<span class="n">countries</span> <span class="o">=</span> <span class="n">ch1_data</span><span class="p">[</span><span class="s2">&quot;adjacency_matrix&quot;</span><span class="p">][</span><span class="s2">&quot;countries&quot;</span><span class="p">]</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">adjacency_matrix_to_graph</span><span class="p">(</span><span class="n">Z_visual</span><span class="p">,</span> <span class="n">countries</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="n">centrality</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">eigenvector_centrality</span><span class="p">(</span><span class="n">Z_visual</span><span class="p">,</span> <span class="n">authority</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">node_total_exports</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">node_total_exports</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">edge_weights</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">edge_weights</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

<span class="n">node_pos_dict</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

<span class="n">node_sizes</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">normalise_weights</span><span class="p">(</span><span class="n">node_total_exports</span><span class="p">,</span><span class="mi">3000</span><span class="p">)</span>
<span class="n">edge_widths</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">normalise_weights</span><span class="p">(</span><span class="n">edge_weights</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>


<span class="n">node_colors</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">colorise_weights</span><span class="p">(</span><span class="n">centrality</span><span class="p">)</span>
<span class="n">node_to_color</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span><span class="n">node_colors</span><span class="p">))</span>
<span class="n">edge_colors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">src</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
    <span class="n">edge_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node_to_color</span><span class="p">[</span><span class="n">src</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>
                       <span class="n">node_pos_dict</span><span class="p">,</span>
                       <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span>
                       <span class="n">node_size</span><span class="o">=</span><span class="n">node_sizes</span><span class="p">,</span>
                       <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span>
                       <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                       <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>
                        <span class="n">node_pos_dict</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>
                       <span class="n">node_pos_dict</span><span class="p">,</span>
                       <span class="n">edge_color</span><span class="o">=</span><span class="n">edge_colors</span><span class="p">,</span>
                       <span class="n">width</span><span class="o">=</span><span class="n">edge_widths</span><span class="p">,</span>
                       <span class="n">arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">arrowsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                       <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                       <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
                       <span class="n">node_size</span><span class="o">=</span><span class="n">node_sizes</span><span class="p">,</span>
                       <span class="n">connectionstyle</span><span class="o">=</span><span class="s1">&#39;arc3,rad=0.15&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<figure class="align-default" id="financial-network">
<a class="reference internal image-reference" href="_images/aec93beef883c2580a97eb8331f2a9dbebd0954b6bed94568d7c9262e7c117cb.png"><img alt="_images/aec93beef883c2580a97eb8331f2a9dbebd0954b6bed94568d7c9262e7c117cb.png" src="_images/aec93beef883c2580a97eb8331f2a9dbebd0954b6bed94568d7c9262e7c117cb.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 41.4 </span><span class="caption-text">国际信贷网络</span><a class="headerlink" href="#financial-network" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>国家代码在下表中给出</p>
<div class="pst-scrollable-table-container"><table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-center head"><p>代码</p></th>
<th class="text-left head"><p>国家</p></th>
<th class="text-center head"><p>代码</p></th>
<th class="text-center head"><p>国家</p></th>
<th class="text-center head"><p>代码</p></th>
<th class="text-center head"><p>国家</p></th>
<th class="text-center head"><p>代码</p></th>
<th class="text-center head"><p>国家</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>AU</p></td>
<td class="text-left"><p>澳大利亚</p></td>
<td class="text-center"><p>DE</p></td>
<td class="text-center"><p>德国</p></td>
<td class="text-center"><p>CL</p></td>
<td class="text-center"><p>智利</p></td>
<td class="text-center"><p>ES</p></td>
<td class="text-center"><p>西班牙</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>PT</p></td>
<td class="text-left"><p>葡萄牙</p></td>
<td class="text-center"><p>FR</p></td>
<td class="text-center"><p>法国</p></td>
<td class="text-center"><p>TR</p></td>
<td class="text-center"><p>土耳其</p></td>
<td class="text-center"><p>GB</p></td>
<td class="text-center"><p>英国</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>US</p></td>
<td class="text-left"><p>美国</p></td>
<td class="text-center"><p>IE</p></td>
<td class="text-center"><p>爱尔兰</p></td>
<td class="text-center"><p>AT</p></td>
<td class="text-center"><p>奥地利</p></td>
<td class="text-center"><p>IT</p></td>
<td class="text-center"><p>意大利</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>BE</p></td>
<td class="text-left"><p>比利时</p></td>
<td class="text-center"><p>JP</p></td>
<td class="text-center"><p>日本</p></td>
<td class="text-center"><p>SW</p></td>
<td class="text-center"><p>瑞士</p></td>
<td class="text-center"><p>SE</p></td>
<td class="text-center"><p>瑞典</p></td>
</tr>
</tbody>
</table>
</div>
<p>图中从日本到美国的箭头代表日本银行对美国注册银行的总债权，这些数据来自国际清算银行（BIS）的统计。</p>
<p>节点的大小反映了该国家从其他所有国家获得的外国债权总额——节点越大，收到的债权越多。</p>
<p>箭头的粗细则表示债权流动的规模——箭头越粗，债权金额越大。</p>
<p>值得注意的是，这个网络中几乎每对国家之间都存在债权关系，也就是说，对于大多数节点对<span class="math notranslate nohighlight">\(u\)</span>和<span class="math notranslate nohighlight">\(v\)</span>，都有一条连接它们的边<span class="math notranslate nohighlight">\((u, v)\)</span>。</p>
<p>（实际上网络中还有更多较小的债权流动，为了图表清晰我们没有全部显示。）</p>
<p>在这种情况下，仅仅关注边的存在与否提供的信息有限。要真正理解这个金融网络，我们不仅需要知道债权流动的存在，更需要了解这些流动的具体规模。</p>
<p>因此，”加权有向图”是描述这种网络结构的最合适的数据结构。</p>
</section>
<section id="id12">
<h3><span class="section-number">41.5.2. </span>定义<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h3>
<p><strong>加权有向图</strong>是一个有向图，其中每条边都被赋予一个正数值，称为<strong>权重</strong>。这些权重通过一个函数<span class="math notranslate nohighlight">\(w\)</span>来定义，该函数将每条边映射到一个相应的数值。</p>
<p>前面展示的国际银行债权网络就是一个加权有向图的例子，其中权重表示资金流动的规模。</p>
<p>下图显示了一个加权有向图，箭头表示有向图的边。</p>
<figure class="align-default" id="poverty-trap-weighted">
<img alt="_images/weighted.png" src="_images/weighted.png" />
<figcaption>
<p><span class="caption-number">Fig. 41.5 </span><span class="caption-text">加权贫困陷阱</span><a class="headerlink" href="#poverty-trap-weighted" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>图中边旁边的数字表示各边的权重。</p>
<p>在这个例子中，这些权重可以解释为家庭在一年内从一种经济状态转移到另一种状态的概率。</p>
<p>例如，我们可以看到一个富裕家庭在一年内有10%的概率变为贫困状态。</p>
</section>
</section>
<section id="id13">
<h2><span class="section-number">41.6. </span>邻接矩阵<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h2>
<p>表示加权有向图的另一种方式是使用邻接矩阵，这种表示方法在进行数值计算时特别有用。</p>
<p>假设我们有一个加权有向图，其节点集为 <span class="math notranslate nohighlight">\(\{v_1, \ldots, v_n\}\)</span>，边集为 <span class="math notranslate nohighlight">\(E\)</span>，权重函数为 <span class="math notranslate nohighlight">\(w\)</span>，则该图的<strong>邻接矩阵</strong>定义为</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = (a_{ij})_{1 \leq i,j \leq n}
\quad \text{其中} \quad
a_{ij} =
%
\begin{cases}
    w(v_i, v_j) &amp; \text{如果} (v_i, v_j) \in E
    \\
    0           &amp; \text{其他情况}
\end{cases}
%
\end{split}\]</div>
<p>一旦 <span class="math notranslate nohighlight">\(V\)</span> 中的节点被列举出来，权重函数和邻接矩阵本质上提供相同的信息。</p>
<p>例如，将 <span class="math notranslate nohighlight">\(\{\)</span>贫困, 中产, 富裕<span class="math notranslate nohighlight">\(\}\)</span> 分别映射到 <span class="math notranslate nohighlight">\(\{1, 2, 3\}\)</span>，
<a class="reference internal" href="#poverty-trap-weighted"><span class="std std-numref">Fig. 41.5</span></a> 中加权有向图对应的邻接矩阵是</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{pmatrix}
    0.9 &amp; 0.1 &amp; 0 \\
    0.4 &amp; 0.4 &amp; 0.2 \\
    0.1 &amp; 0.1 &amp; 0.8
\end{pmatrix}.
\end{split}\]</div>
<p>在 QuantEcon 的 <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code> 实现中，权重通过关键字 <code class="docutils literal notranslate"><span class="pre">weighted</span></code> 记录：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">((</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
     <span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
     <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    <span class="c1"># 储存权重</span>
</pre></div>
</div>
</div>
</div>
<p>关于邻接矩阵的一个关键点是，对其进行转置操作会<em>反转相关有向图中的所有箭头</em>。</p>
<p>例如，以下有向图可以被解释为一个金融网络的简化版本，其中节点代表银行，
边表示资金流动。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G4</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G4</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">),(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">),(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">),(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">)])</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">G4</span><span class="p">)</span>

<span class="n">edge_labels</span><span class="o">=</span><span class="p">{(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">):</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span>
             <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">):</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">):</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span>
             <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">):</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span>
             <span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">):</span> <span class="s1">&#39;500&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">):</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span>
             <span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">):</span> <span class="s1">&#39;150&#39;</span><span class="p">,(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">):</span> <span class="s1">&#39;250&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">):</span> <span class="s1">&#39;300&#39;</span><span class="p">}</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G4</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">node_size</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G4</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G4</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">node_color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">node_size</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/6ac10e3d96569fa478b665772876447f27cceb3519ecbad0ec3d75da1f26b9d0.png"><img alt="_images/6ac10e3d96569fa478b665772876447f27cceb3519ecbad0ec3d75da1f26b9d0.png" src="_images/6ac10e3d96569fa478b665772876447f27cceb3519ecbad0ec3d75da1f26b9d0.png" style="width: 80%;" /></a>
</div>
</div>
<p>我们看到银行2向银行3发放了200的贷款。</p>
<p>对应的邻接矩阵是</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A =
\begin{pmatrix}
    0 &amp; 100 &amp; 0 &amp; 0 &amp; 0 \\
    50 &amp; 0 &amp; 200 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 100 &amp; 0 \\
    0 &amp; 500 &amp; 0 &amp; 0 &amp; 50 \\
    150 &amp; 0 &amp; 250 &amp; 300 &amp; 0
\end{pmatrix}.
\end{split}\]</div>
<p>其转置是</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A^\top =
\begin{pmatrix}
    0   &amp; 50  &amp; 0   &amp; 0   &amp; 150 \\
    100 &amp; 0   &amp; 0   &amp; 500 &amp; 0 \\
    0   &amp; 200 &amp; 0   &amp; 0   &amp; 250 \\
    0   &amp; 0   &amp; 100 &amp; 0   &amp; 300 \\
    0   &amp; 0   &amp; 0   &amp; 50  &amp; 0
\end{pmatrix}.
\end{split}\]</div>
<p>相应的网络在下图中可视化，显示了贷款发放后的负债网络。</p>
<p>这两个网络（原始和转置）对于分析金融市场都很有用。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G5</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G5</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">),(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">),(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">),(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">)])</span>

<span class="n">edge_labels</span><span class="o">=</span><span class="p">{(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">):</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">):</span> <span class="s1">&#39;150&#39;</span><span class="p">,</span>
             <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">):</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">):</span> <span class="s1">&#39;500&#39;</span><span class="p">,</span>
             <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">):</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">):</span> <span class="s1">&#39;250&#39;</span><span class="p">,</span>
             <span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">):</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">):</span> <span class="s1">&#39;300&#39;</span><span class="p">,</span>
             <span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">):</span> <span class="s1">&#39;50&#39;</span><span class="p">}</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G5</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">node_size</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G5</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G5</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">node_color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">node_size</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/5bbb209ce3e475bf471e0d846a188af18c041cd773a2d382a1fe0e4027c1efc4.png"><img alt="_images/5bbb209ce3e475bf471e0d846a188af18c041cd773a2d382a1fe0e4027c1efc4.png" src="_images/5bbb209ce3e475bf471e0d846a188af18c041cd773a2d382a1fe0e4027c1efc4.png" style="width: 80%;" /></a>
</div>
</div>
<p>任何非负的 <span class="math notranslate nohighlight">\(n \times n\)</span> 矩阵 <span class="math notranslate nohighlight">\(A = (a_{ij})\)</span> 都可以自然地表示为一个加权有向图的邻接矩阵。</p>
<p>具体来说，我们可以将节点集合定义为 <span class="math notranslate nohighlight">\(V = \{1, 2, \ldots, n\}\)</span>，并在 <span class="math notranslate nohighlight">\(a_{ij} &gt; 0\)</span> 时在节点 <span class="math notranslate nohighlight">\(i\)</span> 和 <span class="math notranslate nohighlight">\(j\)</span> 之间添加一条有向边。</p>
<p>每条边 <span class="math notranslate nohighlight">\((i,j)\)</span> 的权重就是矩阵中对应的元素值 <span class="math notranslate nohighlight">\(a_{ij}\)</span>。</p>
<p>这样构造的图被称为由矩阵 <span class="math notranslate nohighlight">\(A\)</span> 生成的加权有向图。</p>
</section>
<section id="id14">
<h2><span class="section-number">41.7. </span>性质<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h2>
<p>假设我们有一个加权有向图，其邻接矩阵为 <span class="math notranslate nohighlight">\(A\)</span>。</p>
<p>我们用 <span class="math notranslate nohighlight">\(a^k_{ij}\)</span> 表示矩阵 <span class="math notranslate nohighlight">\(A^k\)</span>（即 <span class="math notranslate nohighlight">\(A\)</span> 的 <span class="math notranslate nohighlight">\(k\)</span> 次幂）中第 <span class="math notranslate nohighlight">\(i\)</span> 行第 <span class="math notranslate nohighlight">\(j\)</span> 列的元素。</p>
<p>以下结果在图论和网络分析中应用广泛：</p>
<div class="proof theorem admonition" id="graph_theory_property1">
<p class="admonition-title"><span class="caption-number">Theorem 41.1 </span></p>
<section class="theorem-content" id="proof-content">
<p>对于 <span class="math notranslate nohighlight">\(V\)</span> 中的不同节点 <span class="math notranslate nohighlight">\(i, j\)</span> 和任意整数 <span class="math notranslate nohighlight">\(k\)</span>，我们有</p>
<div class="math notranslate nohighlight">
\[
a^k_{i j} &gt; 0
\quad \text{当且仅当} \quad
\text{$j$ 可从 $i$ 到达}。
\]</div>
</section>
</div><p>当 <span class="math notranslate nohighlight">\(k=1\)</span> 时，这个结果很直观：如果 <span class="math notranslate nohighlight">\(a_{ij} &gt; 0\)</span>，则存在从节点 <span class="math notranslate nohighlight">\(i\)</span> 到节点 <span class="math notranslate nohighlight">\(j\)</span> 的直接路径。对于一般情况的证明，可以参考 <span id="id15">[<a class="reference internal" href="zreferences.html#id284" title="Thomas J Sargent and John Stachurski. Economic networks: theory and computation. arXiv preprint arXiv:2203.11972, 2022.">Sargent and Stachurski, 2022</a>]</span>。</p>
<p>回顾我们在特征值讲座中学到的内容，一个非负矩阵 <span class="math notranslate nohighlight">\(A\)</span> 被称为<a class="reference internal" href="eigen_II.html#irreducible"><span class="std std-ref">不可约的</span></a>，当且仅当对于任意一对索引 <span class="math notranslate nohighlight">\((i,j)\)</span>，都存在某个整数 <span class="math notranslate nohighlight">\(k \geq 0\)</span>，使得 <span class="math notranslate nohighlight">\(a^{k}_{ij} &gt; 0\)</span>。</p>
<p>结合前面的定理，我们可以得到以下重要结论（完整证明见 <span id="id16">[<a class="reference internal" href="zreferences.html#id284" title="Thomas J Sargent and John Stachurski. Economic networks: theory and computation. arXiv preprint arXiv:2203.11972, 2022.">Sargent and Stachurski, 2022</a>]</span>）：</p>
<div class="proof theorem admonition" id="graph_theory_property2">
<p class="admonition-title"><span class="caption-number">Theorem 41.2 </span></p>
<section class="theorem-content" id="proof-content">
<p>对于一个加权有向图，以下陈述是等价的：</p>
<ol class="arabic simple">
<li><p>该有向图是强连通的。</p></li>
<li><p>该图的邻接矩阵是不可约的。</p></li>
</ol>
</section>
</div><p>我们用一个简单的例子来说明上述定理。</p>
<p>考虑以下加权有向图。</p>
<img alt="_images/properties.png" id="properties-graph" src="_images/properties.png" />
<p>我们首先将上述网络创建为 Networkx <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code> 对象。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G6</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G6</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">),(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">),(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p>然后我们构建相关的邻接矩阵A。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span>    <span class="c1"># 邻接矩阵A。</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_irreducible</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">result</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_irreducible</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>      <span class="c1">#检查A的不可约性</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">(</span><span class="n">G6</span><span class="p">)</span>      <span class="c1"># 检查图的连通性</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id17">
<h2><span class="section-number">41.8. </span>网络中心性<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h2>
<p>在研究各种网络时，一个反复出现的话题是不同节点的相对”中心性”或”重要性”。</p>
<p>例子包括：</p>
<ul class="simple">
<li><p>搜索引擎对网页的排名</p></li>
<li><p>确定金融网络中最重要的银行（在金融危机时中央银行应该救助哪一家）</p></li>
<li><p>确定经济中最重要的工业部门</p></li>
</ul>
<p>在接下来的内容中，<strong>中心性度量</strong>将每个加权有向图与一个向量<span class="math notranslate nohighlight">\(m\)</span>关联起来，其中<span class="math notranslate nohighlight">\(m_i\)</span>被解释为节点<span class="math notranslate nohighlight">\(v_i\)</span>的中心性（或排名）。</p>
<section id="id18">
<h3><span class="section-number">41.8.1. </span>度中心性<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h3>
<p>在给定的有向图中，衡量节点”重要性”的两个基本指标是其入度和出度。</p>
<p>这两者都提供了一种中心性度量。</p>
<p>入度中心性是一个包含图中每个节点入度的向量。</p>
<p>考虑以下简单例子。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G7</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G7</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">])</span>

<span class="n">G7</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">),(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">),(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;7&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">),(</span><span class="s1">&#39;7&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">)])</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">planar_layout</span><span class="p">(</span><span class="n">G7</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G7</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G7</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="sample-gph-1">
<a class="reference internal image-reference" href="_images/9d32759530ed6631cf87aa247ce64144fa600c4b67a4a71915e3bf2fb6929278.png"><img alt="_images/9d32759530ed6631cf87aa247ce64144fa600c4b67a4a71915e3bf2fb6929278.png" src="_images/9d32759530ed6631cf87aa247ce64144fa600c4b67a4a71915e3bf2fb6929278.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 41.6 </span><span class="caption-text">样本图</span><a class="headerlink" href="#sample-gph-1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>以下代码显示了所有节点的入度中心性。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iG7</span> <span class="o">=</span> <span class="p">[</span><span class="n">G7</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G7</span><span class="o">.</span><span class="n">nodes</span><span class="p">()]</span>   <span class="c1">#计算入度中心性</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iG7</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 2
2 3
3 1
4 3
5 0
6 2
7 0
</pre></div>
</div>
</div>
</div>
<p>考虑<a class="reference internal" href="#financial-network"><span class="std std-numref">Fig. 41.4</span></a>中显示的国际信贷网络。</p>
<p>以下图表显示了每个国家的入度中心性。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">build_unweighted_matrix</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">indegree</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">centrality_plot_data</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">centrality_measures</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="n">countries</span><span class="p">,</span>
                       <span class="s1">&#39;centrality&#39;</span><span class="p">:</span><span class="n">centrality_measures</span><span class="p">,</span>
                       <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">qbn_io</span><span class="o">.</span><span class="n">colorise_weights</span><span class="p">(</span><span class="n">centrality_measures</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                       <span class="p">})</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;centrality&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">centrality_plot_data</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">indegree</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;centrality&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;入度&#39;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">patch</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">handlelength</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/794bc064bff5ef823fcf01a6a9410b3926966bbcfe1f306a8ce285ab753c6c77.png"><img alt="_images/794bc064bff5ef823fcf01a6a9410b3926966bbcfe1f306a8ce285ab753c6c77.png" src="_images/794bc064bff5ef823fcf01a6a9410b3926966bbcfe1f306a8ce285ab753c6c77.png" style="width: 80%;" /></a>
</div>
</div>
<p>虽然入度和出度中心性计算简单，但它们并不总是有用。</p>
<p>在<a class="reference internal" href="#financial-network"><span class="std std-numref">Fig. 41.4</span></a>中，几乎每个节点之间
都存在边，所以基于入度或出度的中心性排名无法有效区分国家。</p>
<p>这在上图中也可以看到。</p>
<p>另一个例子是网络搜索引擎的任务，它在用户输入搜索时按相关性对页面进行排名。</p>
<p>假设网页A的入站链接是网页B的两倍。</p>
<p>入度中心性告诉我们页面A应该获得更高的排名。</p>
<p>但实际上，页面A可能不如页面B重要。</p>
<p>要理解这一点，可以设想指向A页面的链接来自几乎无人访问的页面，而指向B页面的链接则来自访问量极高的页面。</p>
<p>在这种情况下，页面B可能会收到更多访问者，这反过来表明
页面B包含更有价值（或更有趣）的内容。</p>
<p>这一点告诉我们重要性可能是<em>递归的</em>。</p>
<p>这意味着给定节点的重要性取决于
链接到它的其他节点的重要性。</p>
<p>让我们考虑另一个例子：生产网络。</p>
<p>在这种网络中，一个部门的重要性往往取决于它向哪些部门供应产品或服务。换句话说，如果一个部门为许多重要的下游部门提供关键投入，那么这个部门本身也应该被视为重要的。</p>
<p>这与前面网页排名的例子正好相反：在生产网络中，节点的重要性取决于它指向的那些节点（下游客户）的重要性，而不是指向它的节点（上游供应商）的重要性。</p>
<p>接下来我们将介绍的中心性度量正是捕捉了这种递归特性。</p>
</section>
</section>
<section id="id19">
<h2><span class="section-number">41.9. </span>特征向量中心性<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h2>
<p>考虑一个加权有向图，其邻接矩阵为<span class="math notranslate nohighlight">\(A\)</span>。</p>
<p>为了简化表示，我们假设图中的节点集合<span class="math notranslate nohighlight">\(V\)</span>就是整数集<span class="math notranslate nohighlight">\(\{1, 2, \ldots, n\}\)</span>。</p>
<p>我们用<span class="math notranslate nohighlight">\(r(A)\)</span>表示<span class="math notranslate nohighlight">\(A\)</span>的<a class="reference internal" href="eigen_I.html#neumann-series-lemma"><span class="std std-ref">谱半径</span></a>（即<span class="math notranslate nohighlight">\(A\)</span>的特征值中模最大的那个）。</p>
<p>该图的<strong>特征向量中心性</strong>定义为满足以下方程的<span class="math notranslate nohighlight">\(n\)</span>维向量<span class="math notranslate nohighlight">\(e\)</span>：</p>
<div class="math notranslate nohighlight" id="equation-ev-central">
<span class="eqno">(41.1)<a class="headerlink" href="#equation-ev-central" title="Permalink to this equation">#</a></span>\[ 
\begin{aligned}
    e = \frac{1}{r(A)} A e.
\end{aligned}
\]</div>
<p>换句话说，<span class="math notranslate nohighlight">\(e\)</span>是<span class="math notranslate nohighlight">\(A\)</span>的主特征向量（最大特征值的特征向量 —
请看特征值lecture中关于<a class="reference internal" href="eigen_II.html#perron-frobe"><span class="std std-ref">Perron-Frobenius定理</span></a>的讨论。</p>
<p>为了更好地理解<a class="reference internal" href="#equation-ev-central">(41.1)</a>，我们写出某个元素<span class="math notranslate nohighlight">\(e_i\)</span>的完整表达式</p>
<div class="math notranslate nohighlight" id="equation-eq-eicen">
<span class="eqno">(41.2)<a class="headerlink" href="#equation-eq-eicen" title="Permalink to this equation">#</a></span>\[
\begin{aligned}
    e_i = \frac{1}{r(A)} \sum_{1 \leq j \leq n} a_{ij} e_j
\end{aligned}
\]</div>
<p>注意这个定义的递归性质：节点<span class="math notranslate nohighlight">\(i\)</span>的中心性与它所连接的所有节点的中心性成正比，权重就是从<span class="math notranslate nohighlight">\(i\)</span>到这些节点的连接强度。</p>
<p>一个节点的中心性排名会很高，如果它：</p>
<ol class="arabic simple">
<li><p>连接到许多其他节点，</p></li>
<li><p>这些连接的权重较大，并且</p></li>
<li><p>它所连接的节点本身也具有较高的中心性。</p></li>
</ol>
<p>在后续章节中，我们将在生产网络的背景下深入探讨特征向量中心性的应用。</p>
<p>在生产网络中，特征向量中心性高的部门通常是关键<em>供应商</em>，它们为经济中的多个重要部门提供基础投入。</p>
<p>这些部门特别容易受到需求冲击的影响，因为当需求变化时，这些影响会通过网络结构向上游传导。</p>
<p>下面是一个计算特征向量中心性的函数实现。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eigenvector_centrality</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">authority</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   计算矩阵A的主特征向量。假设A是本原矩阵，并使用幂法。</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A_temp</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="k">if</span> <span class="n">authority</span> <span class="k">else</span> <span class="n">A</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A_temp</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">A_temp</span><span class="p">)))</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A_temp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">e</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>让我们为<a class="reference internal" href="#sample-gph-1"><span class="std std-numref">Fig. 41.6</span></a>中生成的图计算特征向量中心性。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">G7</span><span class="p">)</span>         <span class="c1">#计算图的邻接矩阵</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">eigenvector_centrality</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 0.18580570704268037
2 0.18580570704268037
3 0.11483424225608219
4 0.11483424225608219
5 0.14194292957319637
6 0.11483424225608219
7 0.14194292957319637
</pre></div>
</div>
</div>
</div>
<p>虽然节点 <span class="math notranslate nohighlight">\(2\)</span> 和 <span class="math notranslate nohighlight">\(4\)</span> 具有最高的入度中心性，但我们可以看到节点 <span class="math notranslate nohighlight">\(1\)</span> 和 <span class="math notranslate nohighlight">\(2\)</span> 具有最高的特征向量中心性。</p>
<p>让我们重新审视<a class="reference internal" href="#financial-network"><span class="std std-numref">Fig. 41.4</span></a>中的国际信贷网络。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eig_central</span> <span class="o">=</span> <span class="n">eigenvector_centrality</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">centrality_plot_data</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">eig_central</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;centrality&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">patch</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">handlelength</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="eigenvctr-centrality">
<a class="reference internal image-reference" href="_images/4c59a30f149c0023bc6edb979023259cfb388c0aa405018dd119e414e3bdd982.png"><img alt="_images/4c59a30f149c0023bc6edb979023259cfb388c0aa405018dd119e414e3bdd982.png" src="_images/4c59a30f149c0023bc6edb979023259cfb388c0aa405018dd119e414e3bdd982.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 41.7 </span><span class="caption-text">特征向量中心性</span><a class="headerlink" href="#eigenvctr-centrality" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>在这个排名中，信贷供应领域的主要参与者通常获得较高的评分。</p>
<p>日本在此指标中位居榜首，而英国和法国等拥有庞大金融体系的国家也表现突出，紧随其后。</p>
<p>特征向量中心性的一大优点是它不仅考虑节点本身的重要性，还考虑了与之相连的邻居节点的重要性。</p>
<p>谷歌著名的PageRank算法实际上就是特征向量中心性的一种变体，用于为网页建立排名系统。</p>
<p>这一算法的核心思想是：来自重要网页（按度中心性衡量）的链接比来自不太重要网页的链接更有分量。</p>
<section id="id20">
<h3><span class="section-number">41.9.1. </span>卡茨中心性<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h3>
<p>特征向量中心性存在一个潜在问题：当<span class="math notranslate nohighlight">\(r(A)\)</span>为零时，<span class="math notranslate nohighlight">\(1/r(A)\)</span>无法定义。</p>
<p>基于这个原因以及其他一些考虑，研究人员常常转向另一种网络中心性度量——卡茨中心性。</p>
<p>对于一个带权有向图，我们选择参数<span class="math notranslate nohighlight">\(\beta\)</span>使其位于<span class="math notranslate nohighlight">\((0, 1/r(A))\)</span>区间内，然后将<strong>卡茨中心性</strong>定义为满足以下方程的向量<span class="math notranslate nohighlight">\(\kappa\)</span>：</p>
<div class="math notranslate nohighlight" id="equation-katz-central">
<span class="eqno">(41.3)<a class="headerlink" href="#equation-katz-central" title="Permalink to this equation">#</a></span>\[
\kappa_i =  \beta \sum_{1 \leq j 1} a_{ij} \kappa_j + 1
\qquad  \text{对所有 } i \in \{0, \ldots, n-1\}。
\]</div>
<p>这里<span class="math notranslate nohighlight">\(\beta\)</span>是一个可调参数。</p>
<p>用矩阵向量形式表示为：</p>
<div class="math notranslate nohighlight" id="equation-katz-central-vec">
<span class="eqno">(41.4)<a class="headerlink" href="#equation-katz-central-vec" title="Permalink to this equation">#</a></span>\[
\kappa = \mathbf{1} + \beta A \kappa
\]</div>
<p>其中<span class="math notranslate nohighlight">\(\mathbf{1}\)</span>表示全1列向量。</p>
<p>卡茨中心性的基本思想与特征向量中心性相似：如果节点<span class="math notranslate nohighlight">\(i\)</span>被那些本身具有高中心性的节点所链接，那么它也会获得较高的中心性评分。</p>
<p>只要选择<span class="math notranslate nohighlight">\(\beta\)</span>满足<span class="math notranslate nohighlight">\(0 &lt; \beta &lt; 1/r(A)\)</span>，卡茨中心性就能保证有限且唯一，因为此时<span class="math notranslate nohighlight">\(r(\beta A) &lt; 1\)</span>。</p>
<p>在这种情况下，方程<a class="reference internal" href="#equation-katz-central-vec">(41.4)</a>有唯一解：</p>
<div class="math notranslate nohighlight">
\[
\kappa = (I - \beta A)^{-1} \mathbf{1}
\]</div>
<p>这一结果可由<a class="reference internal" href="eigen_I.html#neumann-series-lemma"><span class="std std-ref">诺伊曼级数定理</span></a>直接推导。</p>
<p>参数<span class="math notranslate nohighlight">\(\beta\)</span>的作用是确保中心性度量<span class="math notranslate nohighlight">\(\kappa\)</span>保持有限。</p>
<p>当谱半径<span class="math notranslate nohighlight">\(r(A)&lt;1\)</span>时，我们通常采用<span class="math notranslate nohighlight">\(\beta=1\)</span>作为卡茨中心性的默认计算参数。</p>
</section>
<section id="id21">
<h3><span class="section-number">41.9.2. </span>权威与枢纽<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h3>
<p>搜索引擎设计者发现网页可以通过两种不同方式成为重要节点。</p>
<p>一些页面拥有高<strong>枢纽中心性</strong>，这意味着它们链接到许多有价值的信息源（比如新闻聚合网站）。</p>
<p>而另一些页面则具有高<strong>权威中心性</strong>，表示它们本身包含有价值的信息，这通常体现在有多少重要网站链接到它们（例如知名新闻机构的官方网站）。</p>
<p>这些概念同样适用于经济网络分析，尽管可能使用不同的术语。</p>
<p>我们前面讨论的特征向量中心性和Katz中心性实际上测量的是枢纽中心性。
（如果一个节点指向许多高中心性的节点，那么它自身的中心性也会很高。）</p>
<p>如果我们更关注权威中心性，可以使用相同的定义方法，只需将邻接矩阵转置即可。</p>
<p>这种方法之所以有效，是因为转置操作会反转所有箭头的方向。</p>
<p>（这样一来，如果一个节点接收到来自多个高中心性节点的链接，它的中心性就会变高。）</p>
<p>例如，对于邻接矩阵为<span class="math notranslate nohighlight">\(A\)</span>的加权有向图，其<strong>基于权威的特征向量中心性</strong>是满足以下方程的向量<span class="math notranslate nohighlight">\(e\)</span>：</p>
<div class="math notranslate nohighlight" id="equation-eicena0">
<span class="eqno">(41.5)<a class="headerlink" href="#equation-eicena0" title="Permalink to this equation">#</a></span>\[
e = \frac{1}{r(A)} A^\top e.
\]</div>
<p>与原始定义相比，唯一的区别是用<span class="math notranslate nohighlight">\(A\)</span>的转置替换了<span class="math notranslate nohighlight">\(A\)</span>。</p>
<p>（转置不会改变矩阵的谱半径，所以我们仍然写作<span class="math notranslate nohighlight">\(r(A)\)</span>而非<span class="math notranslate nohighlight">\(r(A^\top)\)</span>。）</p>
<p>按元素表示，这个方程可以写成：</p>
<div class="math notranslate nohighlight" id="equation-eicena">
<span class="eqno">(41.6)<a class="headerlink" href="#equation-eicena" title="Permalink to this equation">#</a></span>\[
e_j = \frac{1}{r(A)} \sum_{1 \leq i \leq n} a_{ij} e_i
\]</div>
<p>从这个公式可以看出，如果许多具有高权威排名的节点都链接到节点<span class="math notranslate nohighlight">\(j\)</span>，那么<span class="math notranslate nohighlight">\(e_j\)</span>的值就会很高。</p>
<p>下图展示了<a class="reference internal" href="#financial-network"><span class="std std-numref">Fig. 41.4</span></a>中国际信贷网络的基于权威的特征向量中心性排名。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ecentral_authority</span> <span class="o">=</span> <span class="n">eigenvector_centrality</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">authority</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">centrality_plot_data</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">ecentral_authority</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;centrality&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">patch</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">handlelength</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<figure class="align-default" id="eigenvector-centrality">
<a class="reference internal image-reference" href="_images/fbf0ee901bdc7ecdf7f06fa834d70faef3f8d9e1f29a181647e2dd781331bae3.png"><img alt="_images/fbf0ee901bdc7ecdf7f06fa834d70faef3f8d9e1f29a181647e2dd781331bae3.png" src="_images/fbf0ee901bdc7ecdf7f06fa834d70faef3f8d9e1f29a181647e2dd781331bae3.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 41.8 </span><span class="caption-text">特征向量权威度</span><a class="headerlink" href="#eigenvector-centrality" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<p>排名靠前的国家通常是那些吸引大量国际信贷流入的国家，尤其是那些从其他重要金融中心获得资金的国家。</p>
<p>从图表中可以明显看出，美国在这个网络中占据主导地位，这反映了其作为全球银行间信贷首选目的地的核心地位。</p>
</section>
</section>
<section id="id22">
<h2><span class="section-number">41.10. </span>进一步阅读<a class="headerlink" href="#id22" title="Permalink to this heading">#</a></h2>
<p>我们将本讲座中讨论的观点应用于：</p>
<p>关于经济和社会网络的教科书包括 <span id="id23">[<a class="reference internal" href="zreferences.html#id281" title="Matthew O Jackson. Social and economic networks. Princeton university press, 2010.">Jackson, 2010</a>]</span>、
<span id="id24">[<a class="reference internal" href="zreferences.html#id282" title="David Easley, Jon Kleinberg, and others. Networks, crowds, and markets. Volume 8. Cambridge university press Cambridge, 2010.">Easley <em>et al.</em>, 2010</a>]</span>、<span id="id25">[<a class="reference internal" href="zreferences.html#id283" title="Stephen P Borgatti, Martin G Everett, and Jeffrey C Johnson. Analyzing social networks. Sage, 2018.">Borgatti <em>et al.</em>, 2018</a>]</span>、
<span id="id26">[<a class="reference internal" href="zreferences.html#id284" title="Thomas J Sargent and John Stachurski. Economic networks: theory and computation. arXiv preprint arXiv:2203.11972, 2022.">Sargent and Stachurski, 2022</a>]</span> 和 <span id="id27">[<a class="reference internal" href="zreferences.html#id285" title="Sanjeev Goyal. Networks: An economics approach. MIT Press, 2023.">Goyal, 2023</a>]</span>。</p>
<p>在网络科学领域，<span id="id28">[<a class="reference internal" href="zreferences.html#id286" title="Mark Newman. Networks. Oxford university press, 2018.">Newman, 2018</a>]</span>、<span id="id29">[<a class="reference internal" href="zreferences.html#id287" title="Filippo Menczer, Santo Fortunato, and Clayton A Davis. A first course in network science. Cambridge University Press, 2020.">Menczer <em>et al.</em>, 2020</a>]</span> 和
<span id="id30">[<a class="reference internal" href="zreferences.html#id288" title="Michele Coscia. The atlas for the aspiring network scientist. arXiv preprint arXiv:2101.00863, 2021.">Coscia, 2021</a>]</span> 的著作都非常出色。</p>
</section>
<section id="id31">
<h2><span class="section-number">41.11. </span>练习<a class="headerlink" href="#id31" title="Permalink to this heading">#</a></h2>
<div class="exercise admonition" id="networks_ex1">

<p class="admonition-title"><span class="caption-number">Exercise 41.1 </span></p>
<section id="exercise-content">
<p>这是一个适合喜欢数学证明的人的练习。</p>
<p>设 <span class="math notranslate nohighlight">\((V, E)\)</span> 是一个有向图，若 <span class="math notranslate nohighlight">\(u\)</span> 和 <span class="math notranslate nohighlight">\(v\)</span> 互通，则记作 <span class="math notranslate nohighlight">\(u \sim v\)</span>。</p>
<p>证明 <span class="math notranslate nohighlight">\(\sim\)</span> 是 <span class="math notranslate nohighlight">\(V\)</span> 上的<a class="reference external" href="https://en.wikipedia.org/wiki/Equivalence_relation">等价关系</a>。</p>
</section>
</div>
<div class="solution dropdown admonition" id="networks-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#networks_ex1"> Exercise 41.1</a></p>
<section id="solution-content">
<p><strong>自反性：</strong>
显然，<span class="math notranslate nohighlight">\(u = v \Rightarrow u \rightarrow v\)</span>。
因此，<span class="math notranslate nohighlight">\(u \sim u\)</span>。</p>
<p><strong>对称性：</strong>
假设 <span class="math notranslate nohighlight">\(u \sim v\)</span>
<span class="math notranslate nohighlight">\(\Rightarrow u \rightarrow v\)</span> 且 <span class="math notranslate nohighlight">\(v \rightarrow u\)</span>。
根据定义，这意味着 <span class="math notranslate nohighlight">\(v \sim u\)</span>。</p>
<p><strong>传递性：</strong>
假设 <span class="math notranslate nohighlight">\(u \sim v\)</span> 且 <span class="math notranslate nohighlight">\(v \sim w\)</span>
这意味着，<span class="math notranslate nohighlight">\(u \rightarrow v\)</span> 且 <span class="math notranslate nohighlight">\(v \rightarrow u\)</span>，同时 <span class="math notranslate nohighlight">\(v \rightarrow w\)</span> 且 <span class="math notranslate nohighlight">\(w \rightarrow v\)</span>。
因此，我们可以得出 <span class="math notranslate nohighlight">\(u \rightarrow v \rightarrow w\)</span> 且 <span class="math notranslate nohighlight">\(w \rightarrow v \rightarrow u\)</span>。
这意味着 <span class="math notranslate nohighlight">\(u \sim w\)</span>。</p>
</section>
</div>
<div class="exercise admonition" id="networks_ex2">

<p class="admonition-title"><span class="caption-number">Exercise 41.2 </span></p>
<section id="exercise-content">
<p>考虑一个有向图 <span class="math notranslate nohighlight">\(G\)</span>，其节点集为
$<span class="math notranslate nohighlight">\(
V = \{0,1,2,3,4,5,6,7\}
\)</span><span class="math notranslate nohighlight">\(
边集为
\)</span><span class="math notranslate nohighlight">\(
E = \{(0, 1), (0, 3), (1, 0), (2, 4), (3, 2), (3, 4), (3, 7), (4, 3), (5, 4), (5, 6), (6, 3), (6, 5), (7, 0)\}
\)</span>$</p>
<ol class="arabic simple">
<li><p>使用 <code class="docutils literal notranslate"><span class="pre">Networkx</span></code> 绘制图 <span class="math notranslate nohighlight">\(G\)</span>。</p></li>
<li><p>找出 <span class="math notranslate nohighlight">\(G\)</span> 的相关邻接矩阵 <span class="math notranslate nohighlight">\(A\)</span>。</p></li>
<li><p>使用上面定义的函数计算 <span class="math notranslate nohighlight">\(G\)</span> 的入度中心性、出度中心性和特征向量中心性。</p></li>
</ol>
</section>
</div>
<div class="solution dropdown admonition" id="networks-solution-5">

<p class="admonition-title">Solution to<a class="reference internal" href="#networks_ex2"> Exercise 41.2</a></p>
<section id="solution-content">
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 首先，让我们绘制给定的图</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>  <span class="c1"># 添加节点</span>

<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>       <span class="c1"># 添加边</span>
                  <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1815bd4222aa3089d31744613b3108681ad0d24323c0312cf24d565ae0079ce5.png"><img alt="_images/1815bd4222aa3089d31744613b3108681ad0d24323c0312cf24d565ae0079ce5.png" src="_images/1815bd4222aa3089d31744613b3108681ad0d24323c0312cf24d565ae0079ce5.png" style="width: 80%;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>      <span class="c1">#求G的邻接矩阵</span>

<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 1., 0., 1., 0., 0., 0., 0.],
       [1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 0., 1., 0., 1., 0., 0., 1.],
       [0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 1., 0.],
       [0., 0., 0., 1., 0., 1., 0., 0.],
       [1., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oG</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()]</span>   <span class="c1"># 计算入度中心性</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">oG</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 2
1 1
2 1
3 3
4 1
5 2
6 2
7 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">eigenvector_centrality</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>   <span class="c1"># 计算特征向量中心性</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 0.1458980838002507
2 0.09016989800748738
3 0.055728056024793506
4 0.14589810100962303
5 0.09016994824024988
6 0.1803397955498566
7 0.2016262193602515
8 0.09016989800748738
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="exercise admonition" id="networks_ex3">

<p class="admonition-title"><span class="caption-number">Exercise 41.3 </span></p>
<section id="exercise-content">
<p>考虑一个有 <span class="math notranslate nohighlight">\(n\)</span> 个节点和 <span class="math notranslate nohighlight">\(n \times n\)</span> 邻接矩阵 <span class="math notranslate nohighlight">\(A\)</span> 的图 <span class="math notranslate nohighlight">\(G\)</span>。</p>
<p>令 <span class="math notranslate nohighlight">\(S = \sum_{k=0}^{n-1} A^k\)</span>
我们可以说对于任意两个节点 <span class="math notranslate nohighlight">\(i\)</span> 和 <span class="math notranslate nohighlight">\(j\)</span>，当且仅当 <span class="math notranslate nohighlight">\(S_{ij} &gt; 0\)</span> 时，<span class="math notranslate nohighlight">\(j\)</span> 可从 <span class="math notranslate nohighlight">\(i\)</span> 到达。</p>
<p>设计一个函数 <code class="docutils literal notranslate"><span class="pre">is_accessible</span></code>，用于检查给定图中的任意两个节点是否可达。</p>
<p>考虑 <a class="reference internal" href="#networks_ex2"><span class="std std-numref">Exercise 41.2</span></a> 中的图，并使用此函数检查</p>
<ol class="arabic simple">
<li><p>从 <span class="math notranslate nohighlight">\(2\)</span> 是否可以到达 <span class="math notranslate nohighlight">\(1\)</span></p></li>
<li><p>从 <span class="math notranslate nohighlight">\(3\)</span> 是否可以到达 <span class="math notranslate nohighlight">\(6\)</span></p></li>
</ol>
</section>
</div>
<div class="solution dropdown admonition" id="networks-solution-7">

<p class="admonition-title">Solution to<a class="reference internal" href="#networks_ex3"> Exercise 41.3</a></p>
<section id="solution-content">
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_accessible</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>  <span class="c1"># 添加节点</span>

<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>       <span class="c1"># 添加边</span>
                  <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
                  <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_accessible</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_accessible</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  导言
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="about.html">
   1. 关于这些讲座
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  经济数据
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="long_run_growth.html">
   2. 长期增长
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="business_cycle.html">
   3. 商业周期
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inflation_history.html">
   4. 通货膨胀的历史
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="french_rev.html">
   5. 法国大革命期间的通货膨胀
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inequality.html">
   6. 收入与财富不平等
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  基础工具
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro_supply_demand.html">
   7. 供给与需求导论
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_equations.html">
   8. 线性方程和矩阵代数
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="complex_and_trig.html">
   9. 复数和三角函数
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="geom_series.html">
   10. 基础经济学中的几何级数
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  线性动态：有限视界
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pv.html">
   11. 现值
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cons_smooth.html">
   12. 消费平滑
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="equalizing_difference.html">
   13. 均衡差异模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cagan_ree.html">
   14. 货币主义价格水平理论
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cagan_adaptive.html">
   15. 自适应预期下的货币主义价格水平理论
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  线性动态：无限视界
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="eigen_I.html">
   16. 特征值和特征向量
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="greek_square.html">
   17. 求解平方根
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  概率与分布
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_dist.html">
   18. 分布和概率
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   19. 大数定律与中心极限定理
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monte_carlo.html">
   20. 蒙特卡罗方法与期权定价
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="heavy_tails.html">
   21. 重尾分布
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="schelling.html">
   22. 种族隔离
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  非线性动态
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="scalar_dynam.html">
   23. 一维动力学
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="solow.html">
   24. 索洛-斯旺增长模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cobweb.html">
   25. 蛛网模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="olg.html">
   26. 世代交叠模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="commod_price.html">
   27. 商品价格
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  货币政策与财政政策的相互作用
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="money_inflation.html">
   28. 通过货币资助的政府赤字和价格水平
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="unpleasant.html">
   29. 一些不愉快的货币主义算术
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="money_inflation_nonlinear.html">
   30. 通货膨胀税的拉弗曲线
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="laffer_adaptive.html">
   31. 拉弗曲线与自适应预期
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  随机动态
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_processes.html">
   32. AR(1) 过程
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_chains_I.html">
   33. 马尔科夫链：基本概念
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_chains_II.html">
   34. 马尔科夫链：不可约性与遍历性
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="time_series_with_matrices.html">
   35. 用矩阵代数表示的单变量时间序列
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  优化
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lp_intro.html">
   36. 线性规划
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="short_path.html">
   37. 最短路径
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  高维建模
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="eigen_II.html">
   38. 佩龙-弗罗贝尼乌斯定理
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="input_output.html">
   39. 输入-输出模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   40. 就业的湖泊模型
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   41. 网络
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  市场与竞争性均衡
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="supply_demand_multiple_goods.html">
   42. 多种商品的供需关系
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="supply_demand_heterogeneity.html">
   43. 具有异质性的市场均衡
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  估计
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="simple_linear_regression.html">
   44. 简单线性回归模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   45. 最大似然估计
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  其它
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   46. 故障排除
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   47. 参考文献
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   48. 执行统计数据
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="https://quantecon.github.io/lecture-intro.zh-cn/_notebooks/networks.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-intro.zh-cn/blob/main/lectures/networks.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-intro.zh-cn" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://mybinder.org/v2/gh/QuantEcon/lecture-intro.zh-cn.notebooks/main?urlpath=tree/networks.ipynb">BinderHub</option>
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-intro.zh-cn.notebooks/blob/main/networks.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-intro.zh-cn.notebooks" data-urlpath="tree/lecture-intro.zh-cn.notebooks/networks.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-intro.zh-cn.notebooks/blob/main/networks.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "networks";
                const repoURL = "https://github.com/QuantEcon/lecture-intro.zh-cn.notebooks";
                const urlPath = "tree/lecture-intro.zh-cn.notebooks/networks.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>